#summary Adrian's Code TODO List.

= Introduction =

A whole lot of cleanup work needs to be done to make the more difficult work less painful.

This page is meant primarily as a kick for Adrian to remember what he needs to do.

= Code Changes =

  * Begin shuffling stuff out of src/ that isn't strictly required to be there and is trivial to reorganise (makes code reuse and unit testing easier to sort out)
   * dlink list *done*
   * debug/ctx *done*
   * gb_t *done*
   * kb_t - *done*
   * mem *done*
    * Move initialisation of types init'ed in mem.c out into component modules *(Done)*
    * Convert the legacy mem.c types into locally-scoped MemPool types, reducing the mem.c stuff to buffers only *(done)*
   * mempool *done*
   * memstr *done*
   * cbdata
   * string *done*
   * MemBuf

  * Next - error pages
    * write some simple sed one-liners to take a CSS + template file and generate a static error page
    * Convert the English directory to use this - ignore the other languages for now!

  * Next phase - improving the communication code
    * Bring over a very naive reference-counted buffer type
    * Bring over a very, very basic writev() and readv() wrapper - remember about SSL and the FD_READ/WRITE_METHOD() stuff!
    * Use the writev() wrapper for writing HTTP replies, avoiding the copying

  * Next - resolve issue #10 (Service time differences!) if it hasn't been resolved already.

= Benchmarking =

  * Benchmark with / without mempools - try to establish which areas of the codebase are (ab)using malloc far too often
  * Try to figure out the 'best' buffer sizes for doing socket and disk IO

= Additions for Cacheboy-1.0 =

  * Solaris Event Ports - shouldn't be difficult; can almost merge /dev/poll + kqueue support to get network-only IO ports implemented (and ignore trying to use AIO for now!) - *(Done)*
  * Nothing else - get the codebase out there and stable!
  * Error pages, perhaps?

= Additions for Cacheboy-1.1 =

  * Tidy up and commit the ZPH patch stuff? this is already included in Squid-2.HEAD.
  * TPROXY-4 support - already coded up, just need to test it before committing! Or bring over what ends up in Squid-2.HEAD ?