<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
 <TITLE>Squid 2.6.PRE1 release notes</TITLE>
</HEAD>
<BODY>
<H1>Squid 2.6.PRE1 release notes</H1>

<H2>Squid Developers</H2>$Id$
<HR>
<EM>This document contains the release notes for version 2.6 of Squid.
Squid is a WWW Cache application developed by the National Laboratory
for Applied Network Research and members of the Web Caching community.</EM>
<HR>
<H2><A NAME="s1">1. Key changes from squid 2.5:</A></H2>

<P>
<UL>
<LI>...</LI>
</UL>
</P>

<H2><A NAME="s2">2. Changes to squid.conf</A></H2>

<P>
<DL>
<DT><B>http_port</B><DD><P>Now takes a list of options in addition to the port address, specifying the purpose of this http_port. Default is plain Internet proxy as usual.</P>
<DT><B>httpd_accel_* for transparent proxy</B><DD><P>Now implemented by the "transparent" http_port option</P>
<DT><B>httpd_accel_host</B><DD><P>Replaced by defaultsite http_port option and cache_peer originserver option.</P>
<DT><B>httpd_accel_port</B><DD><P>No longer needed. Server port defined by the cache_peer port.</P>
<DT><B>httpd_accel_uses_host_header</B><DD><P>Replaced by vhost http_port option</P>
<DT><B>https_port</B><DD><P>Many new options. Reconstructs URLs as https:// by default.</P>
<DT><B>cache_peer</B><DD><P>Many new options to support origin servers and SSL encryption</P>
<DT><B>ssl_engine</B><DD><P>New directive for hardware assisted SSL encryption</P>
<DT><B>sslproxy_*</B><DD><P>New directives defining how to gateway http-&gt;https</P>
<DT><B>sslpassword_program</B><DD><P>New helper directive to query an external program for SSL key encryption password (if any)</P>
<DT><B>cache_vary</B><DD><P>New directive to disable caching of Vary:ing responses</P>
<DT><B>logformat</B><DD><P>New directive for defining custom log formats</P>
<DT><B>cache_access_log</B><DD><P>Renamed to access_log</P>
<DT><B>access_log</B><DD><P>Select what requests to log where any by what format. Support for multiple log files and multiple log formats.</P>
<DT><B>check_hostnames</B><DD><P>New option to disable the hostname validity/sanity checks usually performed by Squid, replacing the similar build time configure option in 2.5.</P>
<DT><B>allow_underscore</B><DD><P>New option to allow _ in hostnames, replacing the similar build time configure option in 2.5 and earlier.</P>
<DT><B>redirect_*</B><DD><P>Renamed to url_rewrite_* to better reflect the functionality of this helper</P>
<DT><B>url_rewrite_concurrency</B><DD><P>Activates a new and more efficient helper protocol. Requires changes in the helper.</P>
<DT><B>location_rewrite_*</B><DD><P>New helper hook for rewriting Location headers</P>
<DT><B>auth_param basic blankpassword</B><DD><P>New option to allow the use of blank passwords.</P>
<DT><B>auth_param ntlm max_challenge_reuse / max_challenge_lifetime</B><DD><P>No longer supported</P>
<DT><B>auth_param ntlm use_ntlm_negotiate</B><DD><P>Now defaults to "on"</P>
<DT><B>auth_param ntlm keep_alive</B><DD><P>New option to fine-tune the use of HTTP keep-alive in combination with NTLM</P>
<DT><B>auth_param negotiate</B><DD><P>New Negotiate authentication scheme, the "next generation" scheme in the family of Microsoft authentication.</P>
<DT><B>external_acl_type</B><DD><P>Many new format options %SRCPORT, %MYADDR, %MYPORT, %PATH, %USER_CERT, %ACL, %DATA and a few variants. Helper protocol defaults to the simpler "3.0" protocol, and there is support for a highly efficient protocol via the concurrency= option if supported by the helper.</P>
<DT><B>read_ahead_gap</B><DD><P>New directive to set the response buffer size.</P>
<DT><B>collapsed_forwarding</B><DD><P>New directive to enable an alternative optimized forwarding path when there is very many concurrent requests for the same URL.</P>
<DT><B>refresh_stale_hit</B><DD><P>New directive similar to collapsed_forwarding and activates an alternative optimized request processing when there is very many concurrent requests for the same recently expired URL.</P>
<DT><B>acl urlgroup</B><DD><P>New acl class</P>
<DT><B>acl user_cert</B><DD><P>New acl class matching the user SSL certificate (https_port)</P>
<DT><B>acl ca_cert</B><DD><P>New acl class matching the CA of the user SSL certificate (https_port)</P>
<DT><B>acl ext_user / ext_user_regex</B><DD><P>New acl matching usernames returned by external acl</P>
<DT><B>http_access2</B><DD><P>New http_access type directive but evaluated after url rewrites</P>
<DT><B>log_access</B><DD><P>New directive to limit what gets logged.</P>
<DT><B>httpd_suppress_version_string</B><DD><P>Enable hiding of the Squid version</P>
<DT><B>error_map</B><DD><P>New directive to allow dynamic rewrites of error pages</P>
<DT><B>via</B><DD><P>New directive to disable the use of the Via directive</P>
<DT><B>wccp2_*</B><DD><P>WCCP2 protocol support</P>
<DT><B>linux_tproxy, tproxy_port</B><DD><P>Linux TPROXY support for masquerading outgoing connections as the original client</P>
</DL>
</P>

<H2><A NAME="s3">3. Known issues and limitations</A></H2>

<P>There is a few known issues in this version of Squid which we hope to correct in a later release</P>
<P>
<DL>
<DT><B>SSL acceleration &amp; epoll</B><DD><P>SSL acceleration (--enable-ssl) and epoll does not yet work properly together. We hope to have this corrected before release. Until then beware that SSL connections may hang or cause 100% CPU unless you disable epoll with --disable-epoll.</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=761">#761</A></B><DD><P>assertion failed: cbdata.c:249: "c-&gt;locks &gt; 0" when using diskd</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=888">#888</A></B><DD><P>ntlm_user_pool assertion error on shutdown</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=1420">#1420</A></B><DD><P>302 responses with an Expires header is always cached</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=1500">#1500</A></B><DD><P>diskd related memory corruption under heavy load</P>
</DL>
</P>

<P>Ipfilter 4.x compile problem on HP Tru64
<UL>
<LI>Running configure --enable-ipf-transparent on an HP Tru64 5.1B system with ipfilter 4.x installed, the following error can occur:
<PRE>
      checking if IP-Filter header files are installed... no
      WARNING: Cannot find necessary IP-Filter header files
               Transparent Proxy support WILL NOT be enabled
</PRE>

To fix the problem first check if the ip_fil.h, ip_compat.h, ip_nat.h and ipl.h files are present in
/usr/include/netinet and copy them from ipfilter source tree if needed.
Don't forget to fix files permission and ownership after the copy.<BR>
If the error still persist, run configure making it skip the ip_compat.h test:<BR>
<PRE>
    env ac_cv_header_netinet_ip_compat_h=yes ./configure --enable-ipf-transparent
</PRE>
</LI>
<LI>On Sun Solaris 10, ipfilter 4.0.22 is provided with the OS, but related include files (ip_fil.h, ip_compat.h, ip_nat.h, ipl.h) are missing.<BR>
Before running configure --enable-ipf-transparent, they must be downloaded from the
<A HREF="http://cvs.opensolaris.org/source/xref/usr/src/common/ipf/">OpenSolaris Web Site</A>
in the /usr/include local directory. Don't forget to fix files permission and ownership after the download.</LI>
</UL>
</P>


<P>In addition there is a set of limitations in this version of Squid which we hope to correct later</P>
<P>
<DL>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=1059">#1059</A></B><DD><P>mime.conf and referenced icons must be within chroot</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=692">#692</A></B><DD><P>tcp_outgoing_address using an ident ACL does not work</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=581">#581</A></B><DD><P>acl max_user_ip and multiple authentication schemes</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=528">#528</A></B><DD><P>miss_access fails on "slow" acl types such as dst.</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=513">#513</A></B><DD><P>squid -F is starting server sockets to early</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=457">#457</A></B><DD><P>does not handle swap.state corruption properly</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=410">#410</A></B><DD><P>unstable if runs out of disk space</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=355">#355</A></B><DD><P>diskd may appear slow on low loads</P>
<DT><B>Bug 
<A HREF="http://www.squid-cache.org/bugs/show_bug.cgi?id=219">#219</A></B><DD><P>delay_pools stops working on -k reconfigure</P>
</DL>
</P>

</BODY>
</HTML>
