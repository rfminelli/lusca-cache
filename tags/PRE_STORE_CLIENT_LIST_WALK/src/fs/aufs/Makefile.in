#
#  Makefile for the AUFS storage driver for the Squid Object Cache server
#
#  $Id$
#

FS		= aufs

top_srcdir	= @top_srcdir@
VPATH		= @srcdir@

CC		= @CC@
MAKEDEPEND	= @MAKEDEPEND@
AR_R		= @AR_R@
RANLIB		= @RANLIB@
AC_CFLAGS	= @CFLAGS@
SHELL		= /bin/sh

INCLUDE		= -I../../../include -I$(top_srcdir)/include -I$(top_srcdir)/src/
CFLAGS 		= $(AC_CFLAGS) $(INCLUDE) $(DEFINES)

OUT		= ../$(FS).a

OBJS	 	= \
		aiops.o \
		async_io.o \
		store_dir_aufs.o \
		store_io_aufs.o


all:    $(OUT)

$(OUT): $(OBJS)
	@rm -f ../stamp
	$(AR_R) $(OUT) $(OBJS)
	$(RANLIB) $(OUT)

$(OBJS): $(top_srcdir)/include/version.h ../../../include/autoconf.h

.c.o:
	@rm -f ../stamp
	$(CC) $(CFLAGS) -c $<

clean: 
	-rm -rf *.o *pure_* core ../$(FS).a

distclean:	clean
	-rm -f Makefile
	-rm -f Makefile.bak
	-rm -f tags

install:

tags:
	ctags *.[ch] $(top_srcdir)/src/*.[ch] $(top_srcdir)/include/*.h $(top_srcdir)/lib/*.[ch]

depend:
	$(MAKEDEPEND) $(INCLUDE) -fMakefile *.c
